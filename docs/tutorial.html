

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Tutorial &mdash; cs-brix 0.0.1 documentation</title>
  

  
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />

  
  
  
  

  
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/doctools.js"></script>
        <script src="_static/language_data.js"></script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Classes" href="classes.html" />
    <link rel="prev" title="Documentation for cs-brix library" href="index.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="index.html" class="icon icon-home" alt="Documentation Home"> cs-brix
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="current reference internal" href="#">Tutorial</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#basics-of-building-a-cityscope-indicator">Basics of building a CityScope indicator</a></li>
<li class="toctree-l2"><a class="reference internal" href="#let-s-talk-input-data">Let’s talk input/data</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#id9">}</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id12">]</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#deploy-your-indicator">Deploy your indicator</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="classes.html">Classes</a></li>
<li class="toctree-l1"><a class="reference internal" href="examples.html">Examples</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">cs-brix</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html" class="icon icon-home"></a> &raquo;</li>
        
      <li>Tutorial</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="_sources/tutorial.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="tutorial">
<h1>Tutorial<a class="headerlink" href="#tutorial" title="Permalink to this headline">¶</a></h1>
<div class="section" id="basics-of-building-a-cityscope-indicator">
<h2>Basics of building a CityScope indicator<a class="headerlink" href="#basics-of-building-a-cityscope-indicator" title="Permalink to this headline">¶</a></h2>
<p>Let’s get to it. First, what table are you building for? If you don’t have a specific table, that is totally okay and you can create one [here](<a class="reference external" href="https://cityscope.media.mit.edu/CS_cityscopeJS/">https://cityscope.media.mit.edu/CS_cityscopeJS/</a>). Note: by the time you read this, CityScope might pose some limitations on new projects (‘tables’). Please follow instructions in the link above.
For this tutorial, we crated one called <cite>dungeonmaster</cite>.</p>
<p>An indicator will basically take in data, and produce a result. Each new indicator is built as an subclass of the <cite>Indicator</cite> class provided in this library. Make sure you define three functions: <cite>setup</cite>, <cite>load_module</cite>, and <cite>return_indicator</cite>. Here’s a barebones example of an indicator:</p>
<p><a href="#id1"><span class="problematic" id="id2">``</span></a>`
from brix import Indicator
class MyIndicator(Indicator):</p>
<blockquote>
<div><p>‘’’
Write a description for your indicator here.
‘’’
def setup(self):</p>
<blockquote>
<div><p>‘’’
Think of this as your __init__.
Here you will define the properties of your indicator.
Although there are no required properties, be nice and give your indicator a name.
‘’’
self.name = ‘Alfonso’</p>
</div></blockquote>
<dl class="simple">
<dt>def load_module(self):</dt><dd><p>‘’’
This function is not strictly necessary, but we recommend that you define it if you want to load something from memory. It will make your code more readable.
‘’’
pass</p>
</dd>
<dt>def return_indicator(self, geogrid_data):</dt><dd><p>‘’’
This is the main course of your indicator.
This function takes in <cite>geogrid_data</cite> and returns the value of your indicator.
The library is flexible enough to handle indicators that return a number or a dictionary.
‘’’
return 1</p>
</dd>
</dl>
</div></blockquote>
<p><a href="#id3"><span class="problematic" id="id4">``</span></a><a href="#id5"><span class="problematic" id="id6">`</span></a></p>
</div>
<div class="section" id="let-s-talk-input-data">
<h2>Let’s talk input/data<a class="headerlink" href="#let-s-talk-input-data" title="Permalink to this headline">¶</a></h2>
<p>What is <cite>geogrid_data</cite>?
Every time we create a CityScope table, we define a regularly spaced grid which is overlaid on the city district we’re modelling. These grid cells are the basic unit of analysis for the CityScope modules. Every grid cell has properties such as the ‘Type’ which represents the land use and ‘Height’ which represents the number of floors. These data are dynamic and are updated each time a user interacts with the CityScope table, experimenting with the spatial organisation of land uses and infrastructure. These dynamic data are stored the variable <cite>geogrid_data</cite>. This is a list of ojects: one for each grid cell in the CityScope table. The contents of each object really depends on the specific table you are building for and on the properties assigned to your indicator. There are two options that will control what <cite>geogrid_data</cite> contains which are: <cite>Indicator.requires_geometry</cite> and <cite>Indicator.requires_geogrid_props</cite>. These two properties are set to <cite>False</cite> by default, but you can change them inside the <cite>setup</cite> function depending on the needs of your indicator.</p>
<p>Go ahead, take a look at how this object looks like by instantiating your class and linking it to a table:</p>
<p><code class="docutils literal notranslate"><span class="pre">`</span>
<span class="pre">I</span> <span class="pre">=</span> <span class="pre">MyIndicator()</span>
<span class="pre">I.link_table('dungeonmaster')</span>
<span class="pre">I.get_geogrid_data()</span>
<span class="pre">`</span></code></p>
<p>Please note that the <cite>link_table</cite> should only be used when developing the indicator. For deployment, we’ll use the <cite>Handler</cite> class that is more efficient. You can also skip the <cite>link_table</cite> step by defining the <cite>Indicator.table_name=’dungeonmaster’</cite> property in your <cite>setup</cite> function. You will also notice that as you change the <cite>Indicator.requires_geometry</cite> and <cite>Indicator.requires_geogrid_props</cite> parameters in <cite>setup</cite>, the output of <cite>get_geogrid_data</cite> will change.</p>
<p>If you are testing and are curious how <cite>geogrid_data</cite> would look like if you set <cite>requires_geometry=True</cite>, you can pass the argument to <cite>get_geogrid_data</cite>:</p>
<p><code class="docutils literal notranslate"><span class="pre">`</span>
<span class="pre">I.get_geogrid_data(include_geometries=True)</span>
<span class="pre">`</span></code></p>
<p>### Build and test your indicator (output)</p>
<p>This library ensures that you can focus on what you do best: writing a kick ass <cite>return_indicator</cite> function that will make everyone’s urban planning life better.</p>
<p>To test your function while debugging it, you can use the object returned by <cite>get_geogrid_data</cite>:</p>
<p><code class="docutils literal notranslate"><span class="pre">`</span>
<span class="pre">geogrid_data</span> <span class="pre">=</span> <span class="pre">I.get_geogrid_data()</span>
<span class="pre">I.return_indicator(geogrid_data)</span>
<span class="pre">`</span></code></p>
<p>The property <cite>Indicator.indicator_type</cite> will toggle between a Heatmap indicator or a numeric indicator (<cite>numeric</cite> for nueric and <cite>heatmap</cite> for heatmap).</p>
<p>For numeric indicators, there are multiple ways in which the front end can display them (e.g. bar chart, radar plot, etc.). This is controlled by the <cite>viz_type</cite> property of the class. The default value is set to <cite>Indicator.viz_type=radar</cite> which means that unless it is specified otherwise, all numeric indicators will be added to the radar plot. When building an indicator that returns a single number you can just change the value of this parameter in the <cite>setup()</cite>. When building an indicator that returns multiple numbers it will just assume every number should be displayed in the same front end visualization. If you want to have more fine control of where each indicator is displayed, we recommend building your <cite>return_indicator</cite> function such that it returns a dictionary with the following structure:</p>
<p><a href="#id7"><span class="problematic" id="id8">``</span></a>`
{</p>
<blockquote>
<div><p>‘name’: ‘Social Wellbeing’,
‘value’: random.random(),
‘viz_type’: ‘bar’</p>
</div></blockquote>
<div class="section" id="id9">
<h3>}<a class="headerlink" href="#id9" title="Permalink to this headline">¶</a></h3>
<p>The <cite>viz_type</cite> defined in the return object of <cite>return_indicator</cite> will overwrite any default property defined in <cite>setup</cite>. Remember that your <cite>return_indicator</cite> function can also return a list of indicators. In the following example of a return value for the <cite>return_indicator</cite> function, the indicator returns two numbers that should be displayed in the radar plot, and one to be displayed as a bar chart.</p>
<p><a href="#id10"><span class="problematic" id="id11">``</span></a>`
[</p>
<blockquote>
<div><p>{‘name’: ‘Social Wellbeing’, ‘value’: 0.3, ‘viz_type’: ‘radar’},
{‘name’: ‘Environmental Impact’, ‘value’: 0.1, ‘viz_type’: ‘radar’},
{‘name’: ‘Mobility Impact’, ‘value’: 0.5, ‘viz_type’: ‘bar’}</p>
</div></blockquote>
</div>
<div class="section" id="id12">
<h3>]<a class="headerlink" href="#id12" title="Permalink to this headline">¶</a></h3>
</div>
</div>
<div class="section" id="deploy-your-indicator">
<h2>Deploy your indicator<a class="headerlink" href="#deploy-your-indicator" title="Permalink to this headline">¶</a></h2>
<p>Finally, once you have build a series of indicators, the right way to deploy them is to use the <cite>Handler</cite> class. A <cite>Handler</cite> object should be the go-to connection to the table and will handle all possible exceptions. The two most important methods are <cite>add_indicators</cite> which takes a list of <cite>Indicator</cite> objects and connects them to the table, and <cite>listen</cite> that is a method that runs continuously waiting for updates in the CityScope table. The example below assumes you have already defined indicators named Density, Diversity and Proximity in a file named myindicators.py.</p>
<p><a href="#id13"><span class="problematic" id="id14">``</span></a>`
from brix import Handler
from myindicators import Density, Diversity, Proximity</p>
<p>dens = Density()
divs = Diversity()
prox = Proximity()</p>
<p>H = Handler(‘dungeonmaster’, quietly=False)
H.add_indicators([</p>
<blockquote>
<div><p>dens,
divs,
prox</p>
</div></blockquote>
<p>])
H.listen()
<a href="#id15"><span class="problematic" id="id16">``</span></a><a href="#id17"><span class="problematic" id="id18">`</span></a></p>
<p>To see the indicators in the handler you can use <cite>H.list_indicators()</cite> to list the indicator names, and use <cite>H.return_indicator(&lt;indicator_name&gt;)</cite> to see the value of the indicator. Finally, the function <cite>H.update_package()</cite> will return the data that will be posted on CityIO.</p>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="classes.html" class="btn btn-neutral float-right" title="Classes" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="index.html" class="btn btn-neutral float-left" title="Documentation for cs-brix library" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        
        &copy; Copyright 2020, CityScience group at the MIT Media Lab

    </p>
  </div>
    
    
    
    Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>